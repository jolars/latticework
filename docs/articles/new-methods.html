<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>New methods • tactile</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="New methods">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tactile</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/new-high-level-functions.html">New high-level functions</a>
    </li>
    <li>
      <a href="../articles/new-methods.html">New methods</a>
    </li>
    <li>
      <a href="../articles/new-panel-functions.html">New panel functions</a>
    </li>
    <li>
      <a href="../articles/tactile-theme.html">The tactile theme</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jolars/tactile">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>New methods</h1>
            <h3 class="subtitle">tactile</h3>
                        <h4 class="author">Johan Larsson</h4>
            
            <h4 class="date">2018-04-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jolars/tactile/blob/master/vignettes/new-methods.Rmd"><code>vignettes/new-methods.Rmd</code></a></small>
      <div class="hidden name"><code>new-methods.Rmd</code></div>

    </div>

    
    
<div id="xyplot-lm-linear-model-diagnostics" class="section level2">
<h2 class="hasAnchor">
<a href="#xyplot-lm-linear-model-diagnostics" class="anchor"></a><code><a href="../reference/xyplot.lm.html">xyplot.lm()</a></code>: Linear model diagnostics</h2>
<p>tactile provides an <code>xyplot()</code> method for <code>lm</code> objects – usually generated with <code><a href="http://www.rdocumentation.org/packages/stats/topics/lm">stats::lm()</a></code> or <code><a href="http://www.rdocumentation.org/packages/stats/topics/glm">stats::glm()</a></code>. It provides the same type of diagnostic plots that <code><a href="http://www.rdocumentation.org/packages/stats/topics/plot.lm">stats::plot.lm()</a></code> covers, with some small modificiations.</p>
<p>This method is provided so that a user may use lattice graphics throughout out a document, say for a lab report, and produce consistent graphic material that can be changed on a general level (for instance by using <code>lattice.options()</code>).</p>
<div id="usage" class="section level3">
<h3 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h3>
<p>We fit a simple linear model</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">fit &lt;-<span class="st"> </span><span class="kw">lm</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Sepal.Width, <span class="dt">data =</span> iris)</a></code></pre></div>
<p>Here, we fist use the default option and plot the diagnostics using <code>stats::plot()</code></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>), <span class="dt">cex =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">plot</span>(fit, <span class="dt">which =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)</a></code></pre></div>
<div class="figure">
<img src="new-methods_files/figure-html/unnamed-chunk-2-1.png" alt="Plot diagnostics with `stats::plot.lm()`." width="576"><p class="caption">
Plot diagnostics with <code><a href="http://www.rdocumentation.org/packages/stats/topics/plot.lm">stats::plot.lm()</a></code>.
</p>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</a></code></pre></div>
<p>Or instead use the method provided by tactile.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(tactile)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; Loading required package: lattice</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw">xyplot</span>(fit, <span class="dt">which =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)</a></code></pre></div>
<div class="figure">
<img src="new-methods_files/figure-html/unnamed-chunk-3-1.png" alt="Plot diagnostics with `xyplot.lm()`." width="576"><p class="caption">
Plot diagnostics with <code><a href="../reference/xyplot.lm.html">xyplot.lm()</a></code>.
</p>
</div>
<p>You will see that the results are similar. The benefits, however, of using <code><a href="../reference/xyplot.lm.html">xyplot.lm()</a></code> from tactile are that</p>
<ul>
<li>handling of plot margins is much improved,</li>
<li>the plots are returned as a list of trellis objects (that can be updated),</li>
<li>general plot settings from <code>lattice</code> are respected (mostly), and</li>
<li>you no longer have to specify <code>par(mfrow = c(2, 2))</code>. The plots are arranged via <code><a href="http://www.rdocumentation.org/packages/gridExtra/topics/arrangeGrob">gridExtra::grid.arrange()</a></code> automatically and arguments <code>nrow</code> and <code>ncol</code> have been made accessible in the <code><a href="../reference/xyplot.lm.html">xyplot.lm()</a></code> call to enable manual specifications.</li>
</ul>
</div>
</div>
<div id="xyplot-arima-arima-model-diagnostics" class="section level2">
<h2 class="hasAnchor">
<a href="#xyplot-arima-arima-model-diagnostics" class="anchor"></a><code>xyplot.Arima</code>: ARIMA Model Diagnostics</h2>
<p>This function is similar to <code><a href="../reference/xyplot.lm.html">xyplot.lm()</a></code> but is modelled after <code><a href="http://www.rdocumentation.org/packages/stats/topics/tsdiag">stats::tsdiag()</a></code>. First, we look at the output from the original.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">fit &lt;-<span class="st"> </span><span class="kw">arima</span>(lh, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">tsdiag</span>(fit)</a></code></pre></div>
<p><img src="new-methods_files/figure-html/unnamed-chunk-4-1.png" width="384"></p>
<p>To use the method from tactile, we just call <code>xyplot()</code> on the model fit. The most prominent difference here is that we’ve added a Q-Q plot of the standardized residuals as well, but also that we’re correcting the the Ljung–Box test to account for the fact that we’ve fit a model (<a href="http://www.stat.pitt.edu/stoffer/tsa4/Rissues.htm">see this</a>).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">xyplot</span>(fit)</a></code></pre></div>
<p><img src="new-methods_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div id="xyplot-forecast-plotting-forecasts-with-tactile" class="section level2">
<h2 class="hasAnchor">
<a href="#xyplot-forecast-plotting-forecasts-with-tactile" class="anchor"></a><code><a href="../reference/xyplot.forecast.html">xyplot.forecast()</a></code>: Plotting forecasts with tactile</h2>
<p>Robert Hyndman’s excellent <a href="https://cran.r-project.org/package=forecast">forecast</a> package has built-in functions for plotting forecasts. These have been reworked to use lattice graphics in tactile, and also try to place the forecasts on the time scale of the original data (if such is provided).</p>
<p>For this example, we user <code>USAccDeaths</code>, a time series giving the monthly totals of accidental deaths in the USA. We begin by separating the series into a training and test set.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(forecast)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">train &lt;-<span class="st"> </span><span class="kw">window</span>(USAccDeaths, <span class="kw">c</span>(<span class="dv">1973</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">1977</span>, <span class="dv">12</span>))</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">test &lt;-<span class="st"> </span><span class="kw">window</span>(USAccDeaths, <span class="kw">c</span>(<span class="dv">1978</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">1978</span>, <span class="dv">12</span>))</a></code></pre></div>
<p>Then we fit the model and plot the results.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">fit &lt;-<span class="st"> </span><span class="kw">arima</span>(train, <span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">seasonal =</span> <span class="kw">list</span>(<span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">fcast1 &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/forecast/topics/forecast">forecast</a></span>(fit, <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="kw">xyplot</span>(fcast1, test, <span class="dt">grid =</span> <span class="ot">TRUE</span>, <span class="dt">auto.key =</span> <span class="kw">list</span>(<span class="dt">corner =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.99</span>)),</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">       <span class="dt">ci_key =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">"PI Level"</span>))</a></code></pre></div>
<p><img src="new-methods_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
<p>A so called fan plot can be achieved by increasing the number of prediction intervals in the call to <code>forecast</code>. We also switch to a separate color palette by using the <code>ci_pal</code> argument.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># A fan plot</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">fcast2 &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/forecast/topics/forecast">forecast</a></span>(fit, <span class="dv">12</span>, <span class="dt">level =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">95</span>, <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw">xyplot</span>(fcast2, test, <span class="dt">ci_pal =</span> <span class="kw">heat.colors</span>(<span class="dv">100</span>))</a></code></pre></div>
<p><img src="new-methods_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#xyplot-lm-linear-model-diagnostics"><code><a href="--/reference/xyplot-lm-html">xyplot.lm()</a></code>: Linear model diagnostics</a></li>
      <li><a href="#xyplot-arima-arima-model-diagnostics"><code>xyplot.Arima</code>: ARIMA Model Diagnostics</a></li>
      <li><a href="#xyplot-forecast-plotting-forecasts-with-tactile"><code><a href="--/reference/xyplot-forecast-html">xyplot.forecast()</a></code>: Plotting forecasts with tactile</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Johan Larsson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
